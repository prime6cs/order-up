<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>INSO Order System</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-family: Arial, sans-serif;
            background: #d5bbaa;
        }
        button {
            padding: 12px 20px;
            font-size: 16px;
            cursor: pointer;
        }
        #result {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
        }
    </style>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
    <h1>Please sign in with the school account to continue</h1>
    <!-- replace data-client_id with your own google id -->
    <div id="g_id_onload" data-client_id="827838394950-n1jl23h7nbqprfof6evp731v3o0aesfo.apps.googleusercontent.com" data-callback="handleGoogleSignIn"></div>
    <div class="g_id_signin" data-type="standard" data-size="large" data-theme="outline" data-text="signin_with" data-shape="rectangular" data-logo_alignment="left"></div>
    <button id="login" style="display: flex; align-items: center; gap: 10px; padding: 10px 16px; font-size: 14px; border: 1px solid #dadce0; border-radius: 4px; background: white; cursor: pointer;">
        <img src="https://developers.google.com/identity/images/g-logo.png" width="18" height="18">Sign in with Google
    </button>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        // you can change this variable to use your own config here
        const firebaseConfig = {
              apiKey: "AIzaSyB5h1wU1fc-UF540ZtCO3T2ubiDYiGXqIg",
              authDomain: "db-3dprint.firebaseapp.com",
              projectId: "db-3dprint",
              storageBucket: "db-3dprint.firebasestorage.app",
              messagingSenderId: "827838394950",
              appId: "1:827838394950:web:5e3e2618f765b2bfb41047"
        };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const provider = new GoogleAuthProvider();
        const btn = document.getElementById("login");
        const res = document.getElementById("result");
        btn.onclick = async () => {
            try {
                res.textContent = "Signing in...";
                const response = await signInWithPopup(auth, provider);
                const email = response.user.email;
                // you can change this query if your collection is called smtn different
                res.textContent = `Signed in as ${email}. Checking ordersâ€¦`;
                const q = query(collection(db, "orders"), where("Email Address", "==", email));
                const shot = await getDocs(q);
                if (!shot.empty) {
                    res.textContent = "Found order";
                } else {
                    res.textContent = "No order found";
                }
            } catch (e) {
                console.error(e);
                res.textContent = "Could not login";
            }
        }
    </script>
</body>
</html>
