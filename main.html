<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Main Page</title>
  </head>
  <body>
    <h1 id="status">Please wait...</h1>
    <div id="order"></div>
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
      const firebaseConfig = {
      apiKey: "AIzaSyB5h1wU1fc-UF540ZtCO3T2ubiDYiGXqIg",
      authDomain: "db-3dprint.firebaseapp.com",
      projectId: "db-3dprint",
      storageBucket: "db-3dprint.firebasestorage.app",
      messagingSenderId: "827838394950",
      appId: "1:827838394950:web:5e3e2618f765b2bfb41047"
      };
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const status = document.getElementById("status");
      const oDiv = document.getElementById("order");
      onAuthStateChanged(auth, (user) => {
        if (!user) {
          status.textContent = "Unauthorized, please sign in with the correct email";
          return;
        }
        status.textContent = "Checking for orders...";
        const email = user.email;
        const q = query(collection(db, "orders"), where("Email Address", "==", email));
        const sn = await getDocs(q);
        if (!sn.empty) {
          orderDiv.textContent = "Found order";
        } else {
          orderDiv.textContent = "You currently have no orders.";
        }
          
      });
    </script>
  </body>
</html>
